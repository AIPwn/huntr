# 漏洞类型说明

## 支持的漏洞类型

Vulnhuntr 目前支持检测以下类型的漏洞：

### 1. 本地文件包含 (LFI)

本地文件包含漏洞允许攻击者访问服务器上的任意文件。

**特征：**
- 用户输入直接用于文件路径
- 缺乏路径验证
- 可能包含 `../` 等目录遍历字符

**示例：**
```python
file_path = request.args.get('file')
with open(file_path, 'r') as f:
    content = f.read()
```

### 2. 任意文件覆盖 (AFO)

攻击者可以覆盖服务器上的任意文件。

**特征：**
- 用户输入用于文件路径
- 文件写入操作
- 缺乏权限检查

**示例：**
```python
file_path = request.form.get('path')
with open(file_path, 'w') as f:
    f.write(request.form.get('content'))
```

### 3. 远程代码执行 (RCE)

攻击者可以在服务器上执行任意代码。

**特征：**
- 用户输入用于代码执行
- 动态导入或评估
- 命令执行函数

**示例：**
```python
command = request.args.get('cmd')
os.system(command)
```

### 4. 跨站脚本 (XSS)

攻击者可以在网页中注入恶意脚本。

**特征：**
- 用户输入直接输出到 HTML
- 缺乏输入转义
- JavaScript 执行

**示例：**
```python
user_input = request.form.get('message')
return f"<div>{user_input}</div>"
```

### 5. SQL 注入 (SQLI)

攻击者可以操纵数据库查询。

**特征：**
- 用户输入直接用于 SQL 查询
- 字符串拼接
- 缺乏参数化查询

**示例：**
```python
query = f"SELECT * FROM users WHERE id = {user_input}"
```

### 6. 服务器端请求伪造 (SSRF)

攻击者可以发起任意 HTTP 请求。

**特征：**
- 用户输入用于 URL
- 内部服务访问
- 缺乏 URL 验证

**示例：**
```python
url = request.args.get('url')
response = requests.get(url)
```

### 7. 不安全的直接对象引用 (IDOR)

攻击者可以访问未授权的资源。

**特征：**
- 用户输入用于资源 ID
- 缺乏访问控制
- 直接对象引用

**示例：**
```python
user_id = request.args.get('id')
data = get_user_data(user_id)
```

## 漏洞检测方法

### 1. 静态分析

- 代码模式识别
- 数据流分析
- 控制流分析

### 2. LLM 分析

- 上下文理解
- 漏洞模式识别
- 代码逻辑分析

### 3. 组合分析

- 多步骤漏洞检测
- 跨文件分析
- 完整调用链分析

## 漏洞修复建议

### 1. 通用原则

- 输入验证
- 输出编码
- 最小权限原则
- 纵深防御

### 2. 具体措施

- 使用参数化查询
- 实施访问控制
- 文件路径验证
- 输入转义
- 安全的文件操作

### 3. 最佳实践

- 定期安全审计
- 代码审查
- 安全测试
- 漏洞扫描 